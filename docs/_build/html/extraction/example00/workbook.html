

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>example00: unpolarized TMDs &mdash; JAM3D 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Simulator" href="../../simulation.html" />
    <link rel="prev" title="TMD extraction tool" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> JAM3D
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">JAM3D</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">TMD extraction tool</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#workflow">workflow</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">example00: unpolarized TMDs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-file">Input file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#single-fit">Single fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mc-sampling">MC sampling</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../simulation.html">Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/physics.html">Physics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">JAM3D</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">TMD extraction tool</a> &raquo;</li>
        
      <li>example00: unpolarized TMDs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/extraction/example00/workbook.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="example00-unpolarized-tmds">
<h1>example00: unpolarized TMDs<a class="headerlink" href="#example00-unpolarized-tmds" title="Permalink to this headline">¶</a></h1>
<p>In this example we will extract TMD PDFs and FFs using HERMES SIDIS unpolarized multiplicities.</p>
<div class="section" id="input-file">
<h2>Input file<a class="headerlink" href="#input-file" title="Permalink to this headline">¶</a></h2>
<p>Lets examine the input.py provided at</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">extraction</span><span class="o">/</span><span class="n">examples00</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>At the top we have</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span><span class="o">=</span><span class="p">{}</span>
</pre></div>
</div>
<p>This dictionary serves as a common block in the sense of fortran programming with
the difference that we will be able to add not just numbers but also class objects</p>
<p>We next specify the number of CPU (logical-cores) to be used</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;ncpu&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
<p>The next part is only relevant for MC runs (we will use this later)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;nruns&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;factor&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">4.0</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;kappa&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">1.5</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;tol&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">1e-10</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;itmax&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e7</span><span class="p">)</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;block size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">10</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;nll shift&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<p>We proceed to specify the parameters to be fitted</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>

<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;pdf&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;pdf&#39;</span><span class="p">][</span><span class="s1">&#39;widths1 uv&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">3.90812e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;pdf&#39;</span><span class="p">][</span><span class="s1">&#39;widths1 dv&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">3.90812e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="s1">&#39;widths1 uv&#39;</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;pdf&#39;</span><span class="p">][</span><span class="s1">&#39;widths1 sea&#39;</span><span class="p">]</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">8.14534e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;pdf&#39;</span><span class="p">][</span><span class="s1">&#39;widths2 uv&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">1.72798e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;pdf&#39;</span><span class="p">][</span><span class="s1">&#39;widths2 dv&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">3.90812e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="s1">&#39;widths1 uv&#39;</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;pdf&#39;</span><span class="p">][</span><span class="s1">&#39;widths2 sea&#39;</span><span class="p">]</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>   <span class="o">-</span><span class="mf">3.44763e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>


<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;ff&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;ff&#39;</span><span class="p">][</span><span class="s1">&#39;widths1 pi+ fav&#39;</span><span class="p">]</span>   <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">1.50893e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;ff&#39;</span><span class="p">][</span><span class="s1">&#39;widths1 pi+ unfav&#39;</span><span class="p">]</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">1.22787e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;ff&#39;</span><span class="p">][</span><span class="s1">&#39;widths2 pi+ fav&#39;</span><span class="p">]</span>   <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>   <span class="o">-</span><span class="mf">3.99747e-02</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;ff&#39;</span><span class="p">][</span><span class="s1">&#39;widths2 pi+ unfav&#39;</span><span class="p">]</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">1.42020e-02</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;ff&#39;</span><span class="p">][</span><span class="s1">&#39;widths1 k+ fav&#39;</span><span class="p">]</span>    <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">1.34063e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;ff&#39;</span><span class="p">][</span><span class="s1">&#39;widths1 k+ unfav&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">1.87915e-01</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;ff&#39;</span><span class="p">][</span><span class="s1">&#39;widths2 k+ fav&#39;</span><span class="p">]</span>    <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">0.00000e+00</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="s1">&#39;ff&#39;</span><span class="p">][</span><span class="s1">&#39;widths2 k+ unfav&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mf">0.00000e+00</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
</pre></div>
</div>
<p>The data strucure for the parameters is</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="o">&lt;&lt;</span><span class="n">TMD</span> <span class="n">function</span><span class="o">&gt;&gt;</span><span class="p">][</span><span class="o">&lt;&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">&gt;&gt;</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="nb">bool</span><span class="o">/</span><span class="n">string</span><span class="p">}</span>
</pre></div>
</div>
<p>Here <code class="code docutils literal notranslate"><span class="pre">value</span></code> set the numerical value for the parameter. <code class="code docutils literal notranslate"><span class="pre">min,</span> <span class="pre">max</span></code> specifies the allowed
range for the parameter and  <code class="code docutils literal notranslate"><span class="pre">fixed</span></code> controls whether or not the parameter should be fixed using
<code class="code docutils literal notranslate"><span class="pre">False,True</span></code>. Alternatively the parameter can be set equal to another parameter using the string
name <code class="code docutils literal notranslate"><span class="pre">&lt;&lt;parameter</span> <span class="pre">name&gt;&gt;</span></code>.</p>
<p>Finally we setup the data sets to be include in the analysis</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>

<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">][</span><span class="mi">1000</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;sidis/expdata/1000.xlsx&#39;</span>  <span class="c1"># |  proton   | pi+   | M_Hermes | hermes</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">][</span><span class="mi">1001</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;sidis/expdata/1001.xlsx&#39;</span>  <span class="c1"># |  proton   | pi-   | M_Hermes | hermes</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">][</span><span class="mi">1004</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;sidis/expdata/1004.xlsx&#39;</span>  <span class="c1"># |  deuteron | pi+   | M_Hermes | hermes</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">][</span><span class="mi">1005</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;sidis/expdata/1005.xlsx&#39;</span>  <span class="c1"># |  deuteron | pi-   | M_Hermes | hermes</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">][</span><span class="mi">1002</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;sidis/expdata/1002.xlsx&#39;</span>  <span class="c1"># |  proton   | k+    | M_Hermes | hermes</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">][</span><span class="mi">1003</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;sidis/expdata/1003.xlsx&#39;</span>  <span class="c1"># |  proton   | k-    | M_Hermes | hermes</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">][</span><span class="mi">1006</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;sidis/expdata/1006.xlsx&#39;</span>  <span class="c1"># |  deuteron | k+    | M_Hermes | hermes</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">][</span><span class="mi">1007</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;sidis/expdata/1007.xlsx&#39;</span>  <span class="c1"># |  deuteron | k-    | M_Hermes | hermes</span>

<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">]:</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;fixed&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>

<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;filters&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;xlsx&#39;</span><span class="p">]:</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;filters&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;z&lt;0.6 and Q2&gt;1.69 and pT&gt;0.2 and pT&lt;0.9&quot;</span>
</pre></div>
</div>
<p>The directory <code class="code docutils literal notranslate"><span class="pre">jam3d/database</span></code> contains a collection of datasets sorted by observables e.g SIDIS.  In the
example above we are specifing the SIDIS datasets. The data sets are stored as <code class="code docutils literal notranslate"><span class="pre">&lt;&lt;idx&gt;&gt;.xlsx</span></code> where
<code class="code docutils literal notranslate"><span class="pre">&lt;&lt;idx&gt;&gt;</span></code> is a unique integer identifier within the observable.</p>
<p>Some experimental data sets comes with an overall normalization uncertaninty. Such normalization is
considered to be a nuisance parameter to be constrained in the analysis and can be set to be a free
parameter at <code class="code docutils literal notranslate"><span class="pre">conf['datasets']['sidis']['norm']</span></code>.</p>
<p>Finally filters can be applied at <code class="code docutils literal notranslate"><span class="pre">conf['datasets']['sidis']['filters']</span></code> as shown above.</p>
</div>
<div class="section" id="single-fit">
<h2>Single fit<a class="headerlink" href="#single-fit" title="Permalink to this headline">¶</a></h2>
<p>We next proceed to perform a single fit</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jam3d</span> <span class="o">-</span><span class="n">t</span> <span class="mi">1</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">-t=1</span></code> uses a minimizer that respects the boundaries while  <code class="code docutils literal notranslate"><span class="pre">-t=2</span></code> uses a minimizer that
does not respect the boundaries. There are pros/cons but this is mostly case by case dependent. We
suggest to try both. The program upon completion should print results as follow:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">JAM</span> <span class="n">FITTER</span>                                                                                                                <span class="o">|</span> <span class="n">pdf</span>         <span class="n">widths1</span> <span class="n">sea</span>            <span class="mf">8.14534e-01</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">13</span>                                                                                                                <span class="o">|</span> <span class="n">pdf</span>         <span class="n">widths1</span> <span class="n">uv</span>             <span class="mf">3.90812e-01</span>
<span class="n">elapsed</span> <span class="n">time</span><span class="p">(</span><span class="n">mins</span><span class="p">)</span><span class="o">=</span><span class="mf">0.060276</span>                                                                                               <span class="o">|</span> <span class="n">pdf</span>         <span class="n">widths2</span> <span class="n">sea</span>           <span class="o">-</span><span class="mf">3.44763e-01</span>
<span class="n">shifts</span>  <span class="o">=</span> <span class="mi">8</span>                                                                                                               <span class="o">|</span> <span class="n">pdf</span>         <span class="n">widths2</span> <span class="n">uv</span>             <span class="mf">1.72798e-01</span>
<span class="n">npts</span>    <span class="o">=</span> <span class="mi">978</span>                                                                                                             <span class="o">|</span> <span class="n">ff</span>          <span class="n">widths1</span> <span class="n">pi</span><span class="o">+</span> <span class="n">fav</span>        <span class="mf">1.50893e-01</span>
<span class="n">chi2</span>    <span class="o">=</span> <span class="mf">1169.042354</span>                                                                                                     <span class="o">|</span> <span class="n">ff</span>          <span class="n">widths1</span> <span class="n">pi</span><span class="o">+</span> <span class="n">unfav</span>      <span class="mf">1.22787e-01</span>
<span class="n">rchi2</span>   <span class="o">=</span> <span class="mf">0.000000</span>                                                                                                        <span class="o">|</span> <span class="n">ff</span>          <span class="n">widths2</span> <span class="n">pi</span><span class="o">+</span> <span class="n">fav</span>       <span class="o">-</span><span class="mf">3.99747e-02</span>
<span class="n">nchi2</span>   <span class="o">=</span> <span class="mf">0.000000</span>                                                                                                        <span class="o">|</span> <span class="n">ff</span>          <span class="n">widths2</span> <span class="n">pi</span><span class="o">+</span> <span class="n">unfav</span>      <span class="mf">1.42020e-02</span>
<span class="n">chi2tot</span> <span class="o">=</span> <span class="mf">1169.042354</span>                                                                                                     <span class="o">|</span>
<span class="n">dchi2</span><span class="p">(</span><span class="nb">iter</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.000001</span>                                                                                                   <span class="o">|</span>
<span class="n">dchi2</span><span class="p">(</span><span class="n">local</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.000001</span>                                                                                                  <span class="o">|</span>
                                                                                                                          <span class="o">|</span>
<span class="n">reaction</span><span class="p">:</span> <span class="n">sidis</span>                                                                                                           <span class="o">|</span>
    <span class="n">idx</span>        <span class="n">tar</span>        <span class="n">had</span>        <span class="n">col</span>        <span class="n">obs</span>  <span class="n">npts</span>       <span class="n">chi2</span>      <span class="n">rchi2</span>      <span class="n">nchi2</span>                                <span class="o">|</span>
   <span class="mi">1000</span>     <span class="n">proton</span>        <span class="n">pi</span><span class="o">+</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">127</span>     <span class="mf">325.10</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>                                <span class="o">|</span>
   <span class="mi">1001</span>     <span class="n">proton</span>        <span class="n">pi</span><span class="o">-</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">124</span>     <span class="mf">163.97</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>                                <span class="o">|</span>
   <span class="mi">1002</span>     <span class="n">proton</span>         <span class="n">k</span><span class="o">+</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">122</span>      <span class="mf">72.73</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>                                <span class="o">|</span>
   <span class="mi">1003</span>     <span class="n">proton</span>         <span class="n">k</span><span class="o">-</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">115</span>      <span class="mf">42.49</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>                                <span class="o">|</span>
   <span class="mi">1004</span>   <span class="n">deuteron</span>        <span class="n">pi</span><span class="o">+</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">124</span>     <span class="mf">159.11</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>                                <span class="o">|</span>
   <span class="mi">1005</span>   <span class="n">deuteron</span>        <span class="n">pi</span><span class="o">-</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">122</span>     <span class="mf">158.07</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>                                <span class="o">|</span>
   <span class="mi">1006</span>   <span class="n">deuteron</span>         <span class="n">k</span><span class="o">+</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">122</span>      <span class="mf">78.11</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>                                <span class="o">|</span>
   <span class="mi">1007</span>   <span class="n">deuteron</span>         <span class="n">k</span><span class="o">-</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">122</span>     <span class="mf">169.47</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>                                <span class="o">|</span>
</pre></div>
</div>
<p>The results are automatically written in the <code class="code docutils literal notranslate"><span class="pre">input.py</span></code>. We can check consistency between the screen output and the <code class="code docutils literal notranslate"><span class="pre">input.py</span></code>
At this point one can study the results to make plots etc. An example jupyter notebook is shown below. The first block lists the various external
tools used to analyze the output.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span><span class="nn">os</span>
<span class="kn">from</span> <span class="nn">fitlab.resman</span> <span class="kn">import</span> <span class="n">RESMAN</span>
<span class="kn">from</span> <span class="nn">fitlab.mcsamp</span> <span class="kn">import</span> <span class="n">MCSAMP</span>
<span class="kn">from</span> <span class="nn">tools.config</span> <span class="kn">import</span> <span class="n">load_config</span><span class="p">,</span><span class="n">conf</span>
<span class="kn">from</span> <span class="nn">tools.tools</span> <span class="kn">import</span> <span class="n">load</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span><span class="n">checkdir</span>
<span class="kn">from</span> <span class="nn">tools.mcstat</span> <span class="kn">import</span> <span class="n">chi2hist</span><span class="p">,</span> <span class="n">parhist</span>
<span class="kn">from</span> <span class="nn">tools.mcproc</span> <span class="kn">import</span> <span class="n">impose_cdf_cut</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">py</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span>  <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="k">def</span> <span class="nf">lprint</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
  <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="n">msg</span><span class="p">)</span>
  <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<p>The next block loads the data files based on the given input file (<code class="code docutils literal notranslate"><span class="pre">input.py</span></code>). As the files are loaded, the notebook
writes out which file has been loaded and how many total data points are being considered.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">load_config</span><span class="p">(</span><span class="s1">&#39;./input.py&#39;</span><span class="p">)</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RESMAN</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;solo&#39;</span><span class="p">,</span><span class="n">ip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">nworkers</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">res</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_residuals</span><span class="p">(</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;parman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">par</span><span class="p">)</span>
<span class="n">npts</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">number of data points = &#39;</span><span class="p">,</span><span class="n">npts</span>
</pre></div>
</div>
<p>The next two sections read through the files and organize the data into tables, printing the column labels and a summary of which
collaborations, observables, and the number of points considered.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ALL</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span> \
          <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>

<span class="n">ALL</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">collaborations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ALL</span><span class="o">.</span><span class="n">col</span><span class="p">)</span>

<span class="k">for</span> <span class="n">collab</span> <span class="ow">in</span> <span class="n">collaborations</span><span class="p">:</span>
    <span class="n">data</span><span class="p">[</span><span class="n">collab</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">data_subset</span> <span class="o">=</span> <span class="n">ALL</span><span class="p">[</span><span class="n">ALL</span><span class="o">.</span><span class="n">col</span> <span class="o">==</span> <span class="n">collab</span><span class="p">]</span>
    <span class="n">observables</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_subset</span><span class="o">.</span><span class="n">obs</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">observable</span> <span class="ow">in</span> <span class="n">observables</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">collab</span><span class="p">][</span><span class="n">observable</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_subset</span><span class="p">[</span><span class="n">data_subset</span><span class="o">.</span><span class="n">obs</span> <span class="o">==</span> <span class="n">observable</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Collaboration: </span><span class="si">%s</span><span class="s1">, Observerable: </span><span class="si">%s</span><span class="s1">, Points: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">collab</span><span class="p">,</span> <span class="n">observable</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">collab</span><span class="p">][</span><span class="n">observable</span><span class="p">])))</span>
</pre></div>
</div>
<p>Once the data has been organized, it can be plotted using the following code. This code will take any one of the data files
from the ones considered, and if the observed hadron is positive, plots the curve red, and plots the curve blue if the hadron is negative.
Because different collaborations have binned x and z differently, specific functions must be defined to consider the correct
regions. These plots show the observable <code class="code docutils literal notranslate"><span class="pre">M</span></code> vs the transverse momentum <code class="code docutils literal notranslate"><span class="pre">pT</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
  <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ALL</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span> \
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>

<span class="n">ALL</span><span class="o">.</span><span class="n">columns</span>

<span class="k">def</span> <span class="nf">plotHERMES</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="n">label1</span><span class="o">=</span><span class="s1">&#39;dataset 1&#39;</span><span class="p">):</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">dat</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
      <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">dat</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
      <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span>
  <span class="n">data1</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">dat</span><span class="p">]</span>
  <span class="n">data1</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data1</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
  <span class="n">ZR</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

  <span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
  <span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
  <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
  <span class="k">for</span> <span class="n">xr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]):</span>
      <span class="n">tabx</span><span class="o">=</span><span class="n">data1</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;xr==</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xr</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span>
          <span class="n">tabz</span><span class="o">=</span><span class="n">tabx</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;z&gt;</span><span class="si">%f</span><span class="s1"> and z&lt;</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
          <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
          <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="n">cnt</span><span class="p">)</span>

          <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">col</span><span class="p">)</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span> <span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>

  <span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<p>After the plot function has been defined, the function can be called. For example, the data from the HERMES collaboration
for a proton target and an observed pi+ can be plotted by calling the function for the 1000 data file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plotHERMES</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will produce the following plots.</p>
<img alt="../../_images/output_45_0.png" src="../../_images/output_45_0.png" />
<p>For further examples of plotting for different experimental kinematics, see the workbook for MC sampling below. We note that the uncertainties inferred from a single fit is not supported in JAM3D
(i.e. Hessian error propagation). Instead, the uncertainties will be inferred by performing a likelihood analysis using MC sampling.</p>
</div>
<div class="section" id="mc-sampling">
<h2>MC sampling<a class="headerlink" href="#mc-sampling" title="Permalink to this headline">¶</a></h2>
<div class="section" id="samples-generation">
<h3>Samples generation<a class="headerlink" href="#samples-generation" title="Permalink to this headline">¶</a></h3>
<p>The MC sampling is performed via a technique known as Nested Sampling (NS).
The setups for NS are in code-block of  <code class="code docutils literal notranslate"><span class="pre">input.py</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;nruns&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;factor&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">4.0</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;kappa&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">1.5</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;tol&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">1e-10</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;itmax&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e7</span><span class="p">)</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;block size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">10</span>
<span class="n">conf</span><span class="p">[</span><span class="s1">&#39;nll shift&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">conf['factor']</span></code>  and <code class="code docutils literal notranslate"><span class="pre">conf['kappa']</span></code>  are the most relevant parameters in NS.
<code class="code docutils literal notranslate"><span class="pre">conf['factor']</span></code> controls the number of active points in NS:</p>
<div class="math notranslate nohighlight">
\[{\rm active~points} = {\rm factor} \times {\rm number~of~parameters}\]</div>
<p>The sampling is more dense with increasing values of <code class="code docutils literal notranslate"><span class="pre">factor</span></code></p>
<p>With the MC setup, the sampling can be started using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jam3d</span> <span class="o">-</span><span class="n">t</span> <span class="mi">3</span> <span class="nb">input</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>optionally one can add the flag <code class="code docutils literal notranslate"><span class="pre">-p</span></code> to parallelize the likelihood evaluation.</p>
</div>
<div class="section" id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h3>
<p>The example00 comes with a jupyter notebook  to guide the analysis. The relevant
code lines are shown below.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span><span class="nn">os</span>
<span class="kn">from</span> <span class="nn">fitlab.resman</span> <span class="kn">import</span> <span class="n">RESMAN</span>
<span class="kn">from</span> <span class="nn">fitlab.mcsamp</span> <span class="kn">import</span> <span class="n">MCSAMP</span>
<span class="kn">from</span> <span class="nn">tools.config</span> <span class="kn">import</span> <span class="n">load_config</span><span class="p">,</span><span class="n">conf</span>
<span class="kn">from</span> <span class="nn">tools.tools</span> <span class="kn">import</span> <span class="n">load</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span><span class="n">checkdir</span>
<span class="kn">from</span> <span class="nn">tools.mcstat</span> <span class="kn">import</span> <span class="n">chi2hist</span><span class="p">,</span> <span class="n">parhist</span>
<span class="kn">from</span> <span class="nn">tools.mcproc</span> <span class="kn">import</span> <span class="n">impose_cdf_cut</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">py</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="k">def</span> <span class="nf">lprint</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">runs</span><span class="o">=</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./summary.mcp&#39;</span><span class="p">)</span>
<span class="n">load_config</span><span class="p">(</span><span class="s1">&#39;./input.py&#39;</span><span class="p">)</span>
<span class="n">checkdir</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RESMAN</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;solo&#39;</span><span class="p">,</span><span class="n">ip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">nworkers</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">res</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_residuals</span><span class="p">(</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;parman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">par</span><span class="p">)</span>
<span class="n">npts</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">number of data points = &#39;</span><span class="p">,</span><span class="n">npts</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loading</span> <span class="n">sidis</span> <span class="n">data</span> <span class="n">sets</span> <span class="mi">1007</span>
<span class="n">number</span> <span class="n">of</span> <span class="n">data</span> <span class="n">points</span> <span class="o">=</span>  <span class="mi">978</span>
</pre></div>
</div>
</div>
<div class="section" id="chi2-profile-for-each-run">
<h3>Chi2 profile for each run<a class="headerlink" href="#chi2-profile-for-each-run" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">R</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">runs</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="k">continue</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">runs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;nll&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">npts</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="nb">range</span><span class="o">=</span><span class="n">R</span><span class="p">,</span><span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;chi2-npts&#39;</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_5_0.png" src="../../_images/output_5_0.png" />
</div>
<div class="section" id="distribution-of-parameters">
<h3>distribution of parameters<a class="headerlink" href="#distribution-of-parameters" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">parhist</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">runs</span><span class="p">,</span><span class="n">inputmod</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputmod</span><span class="o">=</span><span class="n">inputmod</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ordered_free_params</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tabs_a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tabs</span><span class="p">(</span><span class="n">runs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kind1</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kind2</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]:</span>   <span class="bp">self</span><span class="o">.</span><span class="n">kind1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_ordered_free_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">order</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">kk</span><span class="p">][</span><span class="s1">&#39;fixed&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
                    <span class="n">order</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;datasets&#39;</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="n">kk</span><span class="p">][</span><span class="s1">&#39;fixed&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
                      <span class="n">order</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">kk</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">order</span>

    <span class="k">def</span> <span class="nf">get_tabs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">runs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        create pandas data frame for the samples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tabs</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">tabs_a</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">runs</span><span class="p">:</span>
            <span class="n">tab</span><span class="p">,</span><span class="n">tab_a</span><span class="o">=</span><span class="p">{},{}</span>
            <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;nll&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">runs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;nll&#39;</span><span class="p">]</span>
            <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">runs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span>
            <span class="n">samples</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">runs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;samples&#39;</span><span class="p">])</span>
            <span class="n">active_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">runs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;active p&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)):</span>
                <span class="n">_</span><span class="p">,</span><span class="n">kind</span><span class="p">,</span><span class="n">par</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">par</span><span class="p">))]</span><span class="o">=</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">tab_a</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">par</span><span class="p">))]</span><span class="o">=</span><span class="n">active_p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">tabs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
            <span class="n">tabs_a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tab_a</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tabs</span><span class="p">,</span><span class="n">tabs_a</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tabs</span><span class="p">,</span><span class="n">tabs_a</span><span class="p">,</span><span class="n">entries</span><span class="p">,</span><span class="n">kind1</span><span class="p">,</span><span class="n">kind2</span><span class="p">,</span><span class="n">iRange</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">entries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cnt</span><span class="p">)</span>
            <span class="n">kind</span><span class="p">,</span><span class="n">par</span><span class="o">=</span><span class="n">entries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kind1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="n">_</span><span class="p">:</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="n">_</span><span class="p">][</span><span class="n">par</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="n">_</span><span class="p">][</span><span class="n">par</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
                    <span class="n">R</span><span class="o">=</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">)</span>
                    <span class="n">E0</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="n">_</span><span class="p">][</span><span class="n">par</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kind2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">kind</span><span class="o">==</span><span class="n">_</span><span class="p">:</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="n">_</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">par</span><span class="p">)][</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="n">_</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">par</span><span class="p">)][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
                    <span class="n">R</span><span class="o">=</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">)</span>
                    <span class="n">E0</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="n">_</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">par</span><span class="p">)][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">iRange</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span><span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span>

            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tabs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">_</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">tab</span><span class="o">=</span><span class="n">tabs</span><span class="p">[</span><span class="n">_</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="n">entries</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="nb">range</span><span class="o">=</span><span class="n">R</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">],</span>\
                        <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">_</span><span class="p">))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">tabs</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="n">entries</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="nb">range</span><span class="o">=</span><span class="n">R</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>\
                    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;...&#39;</span><span class="p">,</span>\
                    <span class="n">weights</span><span class="o">=</span><span class="n">tabs</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;weights&#39;</span><span class="p">],</span><span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">E0</span><span class="p">)</span>
            <span class="c1">#ax.plot(tabs_a[&#39;all&#39;][entries[i]],np.zeros(tabs_a[&#39;all&#39;][entries[i]].size),&#39;ro&#39;)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span><span class="n">par</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">hist_widths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">entries</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">kind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="n">kind</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;widths1&#39;</span><span class="p">,</span><span class="s1">&#39;widths2&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">par</span> <span class="ow">and</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">][</span><span class="n">kind</span><span class="p">][</span><span class="n">par</span><span class="p">][</span><span class="s1">&#39;fixed&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
                        <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span><span class="n">par</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabs</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tabs_a</span><span class="p">,</span><span class="n">entries</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kind1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kind2</span><span class="p">,</span><span class="n">iRange</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ph</span><span class="o">=</span><span class="n">parhist</span><span class="p">(</span><span class="n">runs</span><span class="p">)</span>
<span class="n">ph</span><span class="o">.</span><span class="n">hist_widths</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_7_0.png" src="../../_images/output_7_0.png" />
</div>
<div class="section" id="purge-the-samples">
<h3>purge the samples<a class="headerlink" href="#purge-the-samples" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cdfcut</span><span class="o">=</span><span class="mf">0.001</span>
<span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">runs</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">][</span><span class="s1">&#39;weights&#39;</span><span class="p">])</span>
<span class="n">cdf0</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="n">cdf0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">cdf</span><span class="o">=</span><span class="p">[</span><span class="n">cdf0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>  <span class="k">if</span> <span class="n">cdf0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">cdfcut</span><span class="p">]</span>
<span class="n">idx</span><span class="o">=</span><span class="p">[</span><span class="n">i</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>  <span class="k">if</span> <span class="n">cdf0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">cdfcut</span><span class="p">]</span>

<span class="nb">print</span> <span class="s1">&#39;initial size=&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">weights</span><span class="p">,</span><span class="n">samples</span><span class="o">=</span> <span class="n">impose_cdf_cut</span><span class="p">(</span><span class="n">runs</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">],</span><span class="n">cdfcut</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;final   size=&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cdf0</span><span class="p">)),</span><span class="n">cdf0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">cdf</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;CDF&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;number of samples&#39;</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">initial</span> <span class="n">size</span><span class="o">=</span> <span class="mi">1056</span>
<span class="n">final</span>   <span class="n">size</span><span class="o">=</span> <span class="mi">218</span>
</pre></div>
</div>
<img alt="../../_images/output_9_1.png" src="../../_images/output_9_1.png" />
</div>
<div class="section" id="compute-theory">
<h3>compute theory<a class="headerlink" href="#compute-theory" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weights&#39;</span><span class="p">:</span><span class="n">weights</span><span class="p">}</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
    <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">lprint</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)))</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_residuals</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span>  <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">thy</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span>
        <span class="n">norm</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;datasets&#39;</span><span class="p">][</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">shift</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span>
        <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shift</span><span class="o">+</span><span class="n">thy</span><span class="o">/</span><span class="n">norm</span><span class="p">)</span>
<span class="n">save</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="s1">&#39;results/</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="s1">&#39;sidis.dat&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">218</span><span class="o">/</span><span class="mi">218</span>
</pre></div>
</div>
</div>
<div class="section" id="compute-averages">
<h3>compute averages<a class="headerlink" href="#compute-averages" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;results/</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="s1">&#39;sidis.dat&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
<span class="n">thy</span><span class="p">,</span><span class="n">dthy</span><span class="o">=</span><span class="p">{},{}</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="s1">&#39;weights&#39;</span><span class="p">:</span> <span class="k">continue</span>
    <span class="n">thy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ik-&gt;k&#39;</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="n">dthy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ik-&gt;k&#39;</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">],(</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">thy</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">thy</span><span class="p">:</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">thy</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sidisres</span><span class="o">.</span><span class="n">tabs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;dthy&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dthy</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">report</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;resman&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gen_report</span><span class="p">(</span><span class="n">verb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">delimiters</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">report</span><span class="p">)):</span>
    <span class="k">if</span> <span class="s1">&#39;reaction:&#39;</span> <span class="ow">in</span> <span class="n">report</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">delimiters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">data</span><span class="o">=</span><span class="p">{}</span>
<span class="n">nlines</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)):</span>
    <span class="n">ini</span><span class="o">=</span><span class="n">delimiters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">fin</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">fin</span><span class="o">=</span><span class="n">delimiters</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">reaction</span><span class="o">=</span><span class="n">report</span><span class="p">[</span><span class="n">ini</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;reaction:&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="n">reaction</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;raw data&#39;</span><span class="p">:</span><span class="n">report</span><span class="p">[</span><span class="n">ini</span><span class="p">:</span><span class="n">fin</span><span class="p">]}</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">k</span>
    <span class="n">block</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;raw data&#39;</span><span class="p">]</span>
    <span class="n">isep</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">))</span> <span class="k">if</span> <span class="s1">&#39;--------&#39;</span> <span class="ow">in</span> <span class="n">block</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">isep</span><span class="p">)]</span>
    <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;tables&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">isep</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">))]</span>

    <span class="n">tabs</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;tables&#39;</span><span class="p">]:</span>
        <span class="n">info</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">info</span> <span class="k">if</span> <span class="s1">&#39;col&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tabs</span><span class="p">:</span> <span class="n">tabs</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">info</span><span class="o">=</span><span class="p">[[</span><span class="n">ss</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">info</span> <span class="k">if</span> <span class="s1">&#39;col&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">info</span>  <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tabs</span><span class="p">[</span><span class="n">col</span><span class="p">]:</span> <span class="n">tabs</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">value</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">tabs</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;tabs&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">tabs</span>
<span class="n">save</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="s1">&#39;results/data_and_thy.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sidis</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">summary</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;summary&#39;</span><span class="p">]:</span> <span class="nb">print</span> <span class="n">l</span>
<span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">reaction</span><span class="p">:</span> <span class="n">sidis</span>
    <span class="n">idx</span>        <span class="n">tar</span>        <span class="n">had</span>        <span class="n">col</span>        <span class="n">obs</span>  <span class="n">npts</span>       <span class="n">chi2</span>      <span class="n">rchi2</span>      <span class="n">nchi2</span>
   <span class="mi">1000</span>     <span class="n">proton</span>        <span class="n">pi</span><span class="o">+</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">127</span>     <span class="mf">322.28</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
   <span class="mi">1001</span>     <span class="n">proton</span>        <span class="n">pi</span><span class="o">-</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">124</span>     <span class="mf">168.29</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
   <span class="mi">1002</span>     <span class="n">proton</span>         <span class="n">k</span><span class="o">+</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">122</span>      <span class="mf">72.20</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
   <span class="mi">1003</span>     <span class="n">proton</span>         <span class="n">k</span><span class="o">-</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">115</span>      <span class="mf">42.68</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
   <span class="mi">1004</span>   <span class="n">deuteron</span>        <span class="n">pi</span><span class="o">+</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">124</span>     <span class="mf">159.89</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
   <span class="mi">1005</span>   <span class="n">deuteron</span>        <span class="n">pi</span><span class="o">-</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">122</span>     <span class="mf">157.78</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
   <span class="mi">1006</span>   <span class="n">deuteron</span>         <span class="n">k</span><span class="o">+</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">122</span>      <span class="mf">76.20</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
   <span class="mi">1007</span>   <span class="n">deuteron</span>         <span class="n">k</span><span class="o">-</span>     <span class="n">hermes</span>   <span class="n">M_Hermes</span>   <span class="mi">122</span>     <span class="mf">169.94</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-data-and-theory">
<h3>plot data and theory<a class="headerlink" href="#plot-data-and-theory" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;results/data_and_thy.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>1000: tar=p had=pi+</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;tabs&#39;</span><span class="p">][</span><span class="s1">&#39;hermes&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;idx==1000&#39;</span><span class="p">)</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tab</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
<span class="n">ZR</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Q^2$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p_T$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_19_0.png" src="../../_images/output_19_0.png" />
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">xr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]):</span>
    <span class="n">tabx</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;xr==</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xr</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span>
        <span class="n">tabz</span><span class="o">=</span><span class="n">tabx</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;z&gt;</span><span class="si">%f</span><span class="s1"> and z&lt;</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">])</span>

<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_20_0.png" src="../../_images/output_20_0.png" />
<p>1001 tar=p had=pi-</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;tabs&#39;</span><span class="p">][</span><span class="s1">&#39;hermes&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;idx==1001&#39;</span><span class="p">)</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tab</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
<span class="n">ZR</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Q^2$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p_T$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_22_0.png" src="../../_images/output_22_0.png" />
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">xr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]):</span>
    <span class="n">tabx</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;xr==</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xr</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span>
        <span class="n">tabz</span><span class="o">=</span><span class="n">tabx</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;z&gt;</span><span class="si">%f</span><span class="s1"> and z&lt;</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">])</span>

<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_23_0.png" src="../../_images/output_23_0.png" />
<p>1004: tar=d had=pi+</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;tabs&#39;</span><span class="p">][</span><span class="s1">&#39;hermes&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;idx==1004&#39;</span><span class="p">)</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tab</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
<span class="n">ZR</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Q^2$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p_T$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_25_0.png" src="../../_images/output_25_0.png" />
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">xr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]):</span>
    <span class="n">tabx</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;xr==</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xr</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span>
        <span class="n">tabz</span><span class="o">=</span><span class="n">tabx</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;z&gt;</span><span class="si">%f</span><span class="s1"> and z&lt;</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">])</span>

<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_26_0.png" src="../../_images/output_26_0.png" />
<p>1005: tar=d had=pi-</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;tabs&#39;</span><span class="p">][</span><span class="s1">&#39;hermes&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;idx==1005&#39;</span><span class="p">)</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tab</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
<span class="n">ZR</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Q^2$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p_T$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_28_0.png" src="../../_images/output_28_0.png" />
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">xr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]):</span>
    <span class="n">tabx</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;xr==</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xr</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span>
        <span class="n">tabz</span><span class="o">=</span><span class="n">tabx</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;z&gt;</span><span class="si">%f</span><span class="s1"> and z&lt;</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">])</span>

<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_29_0.png" src="../../_images/output_29_0.png" />
<p>1002: tar=p had=K+</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;tabs&#39;</span><span class="p">][</span><span class="s1">&#39;hermes&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;idx==1002&#39;</span><span class="p">)</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tab</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
<span class="n">ZR</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Q^2$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p_T$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_31_0.png" src="../../_images/output_31_0.png" />
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">xr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]):</span>
    <span class="n">tabx</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;xr==</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xr</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span>
        <span class="n">tabz</span><span class="o">=</span><span class="n">tabx</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;z&gt;</span><span class="si">%f</span><span class="s1"> and z&lt;</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">])</span>

<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_32_0.png" src="../../_images/output_32_0.png" />
<p>1003: tar=p had=K-</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;tabs&#39;</span><span class="p">][</span><span class="s1">&#39;hermes&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;idx==1003&#39;</span><span class="p">)</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tab</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
<span class="n">ZR</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Q^2$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p_T$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_34_0.png" src="../../_images/output_34_0.png" />
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">xr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]):</span>
    <span class="n">tabx</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;xr==</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xr</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span>
        <span class="n">tabz</span><span class="o">=</span><span class="n">tabx</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;z&gt;</span><span class="si">%f</span><span class="s1"> and z&lt;</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">])</span>

<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_35_0.png" src="../../_images/output_35_0.png" />
<p>1006: tar=d had=K+</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;tabs&#39;</span><span class="p">][</span><span class="s1">&#39;hermes&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;idx==1006&#39;</span><span class="p">)</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tab</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
<span class="n">ZR</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Q^2$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p_T$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_37_0.png" src="../../_images/output_37_0.png" />
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">xr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]):</span>
    <span class="n">tabx</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;xr==</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xr</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span>
        <span class="n">tabz</span><span class="o">=</span><span class="n">tabx</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;z&gt;</span><span class="si">%f</span><span class="s1"> and z&lt;</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">])</span>

<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_38_0.png" src="../../_images/output_38_0.png" />
<p>1007: tar=d had=K-</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sidis&#39;</span><span class="p">][</span><span class="s1">&#39;tabs&#39;</span><span class="p">][</span><span class="s1">&#39;hermes&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;idx==1007&#39;</span><span class="p">)</span>
<span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tab</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
<span class="n">ZR</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Q^2$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p_T$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
<span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_40_0.png" src="../../_images/output_40_0.png" />
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">ncols</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span><span class="n">nrows</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">xr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;xr&#39;</span><span class="p">]):</span>
    <span class="n">tabx</span><span class="o">=</span><span class="n">tab</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;xr==</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">xr</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">zr</span> <span class="ow">in</span> <span class="n">ZR</span><span class="p">:</span>
        <span class="n">tabz</span><span class="o">=</span><span class="n">tabx</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;z&gt;</span><span class="si">%f</span><span class="s1"> and z&lt;</span><span class="si">%f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">zr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">py</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">,</span><span class="n">cnt</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;pT&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">],</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;thy&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">tabz</span><span class="p">[</span><span class="s1">&#39;dthy&#39;</span><span class="p">])</span>

<span class="n">py</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_41_0.png" src="../../_images/output_41_0.png" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../simulation.html" class="btn btn-neutral float-right" title="Simulator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="TMD extraction tool" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, N. Sato

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>